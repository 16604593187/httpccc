待优化任务清单：

## HTTP 服务器优化与扩展任务清单





### 阶段 I：稳定性与协议健壮性（单线程环境）



| 序号    | 任务块                             | 优先级   | 预计代码量 (行) | 预计时间分配 (天) | 涉及文件/模块                                                |
| ------- | ---------------------------------- | -------- | --------------- | ----------------- | ------------------------------------------------------------ |
| **I-1** | **恶意请求防御 (Header 长度限制)** | **高**   | 5-10            | 0.5               | `src/HttpConnection.cpp`                                     |
| **I-2** | **标准状态消息映射实现**           | **高**   | 20-30           | 0.5               | `include/HttpResponse.h`, `src/HttpResponse.cpp`             |
| **I-3** | **Chunked Body Footer 完整处理**   | **中高** | 15-25           | 1                 | `src/HttpConnection.cpp`                                     |
| **I-4** | **连接超时和空闲连接清理**         | **高**   | 30-50           | 1-2               | `src/main.cpp`, `include/HttpConnection.h`, `src/HttpConnection.cpp` |
| **I-5** | **实现基础 POST/PUT 业务逻辑**     | **中高** | 40-70           | 2                 | `src/HttpConnection.cpp` (添加 `handlePostRequest` 逻辑)     |

Export to Sheets

------



### 阶段 II：并发架构升级（线程池）



| 序号     | 任务块                         | 优先级 | 预计代码量 (行) | 预计时间分配 (天) | 涉及文件/模块                                                |
| -------- | ------------------------------ | ------ | --------------- | ----------------- | ------------------------------------------------------------ |
| **II-1** | **线程池基础架构**             | **高** | 100-150         | 3-4               | 新增 `ThreadPool.h/.cpp`                                     |
| **II-2** | **连接回调与线程安全隔离**     | **高** | 50-80           | 2                 | `src/main.cpp`, `src/HttpConnection.cpp` (线程池任务提交逻辑) |
| **II-3** | **Epoll 主线程与工作线程解耦** | **高** | 30-50           | 1-2               | `src/main.cpp` (使用 **eventfd** 或 **管道** 在主线程和工作线程间通信) |

Export to Sheets

------



### 阶段 III：高级特性与优化（多线程环境）



| 序号      | 任务块                      | 优先级 | 预计代码量 (行) | 预计时间分配 (天) | 涉及文件/模块                                                |
| --------- | --------------------------- | ------ | --------------- | ----------------- | ------------------------------------------------------------ |
| **III-1** | **异步、线程安全日志系统**  | **高** | 150-250         | 4-5               | 新增 `Logger.h/.cpp` (涉及同步队列、独立线程)                |
| **III-2** | **HTTP/1.1 Range 请求支持** | **中** | 50-100          | 2                 | `src/HttpConnection.cpp` (用于支持大文件断点续传)            |
| **III-3** | **连接/Buffer 内存池化**    | **中** | 80-150          | 3                 | `include/Buffer.h`, 新增内存管理模块                         |
| **III-4** | **HTTPS/TLS 支持**          | **高** | 200+            | 5-7               | 集成 OpenSSL/LibreSSL, `include/socket.h`, `src/HttpConnection.cpp` |

Export to Sheets

------



### 任务清单总览



| 阶段     | 重点目标               | 预计总代码量 (行) | 预计总时间 (天) |
| -------- | ---------------------- | ----------------- | --------------- |
| **I**    | 协议健壮性与单线程稳定 | ~150-200          | ~5              |
| **II**   | 并发架构升级           | ~180-280          | ~6-8            |
| **III**  | 高级特性与性能调优     | ~500+             | ~14-17          |
| **总计** | 完整服务器框架         | **~830+**         | **~25-30**      |

## 深度优化与扩展任务清单（包含学习时间）





### 阶段 IV：性能调优与底层 I/O 优化



| 序号     | 任务块                           | 预计代码量 (行) | **技术栈学习时间 (天)** | **实现与调试时间 (天)** | **总时间分配 (天)** | 重点/难点                                     |
| -------- | -------------------------------- | --------------- | ----------------------- | ----------------------- | ------------------- | --------------------------------------------- |
| **IV-1** | **Epoll ONESHOT 模式实现**       | 50-80           | **2**                   | 3-4                     | **5-6**             | 掌握 **ET/ONESHOT** 状态机，避免竞态。        |
| **IV-2** | **对象池/Arena 内存分配器**      | 150-200         | **3**                   | 4-5                     | **7-8**             | 学习 **Arena Allocator** 设计，实现线程安全。 |
| **IV-3** | **TCP_NODELAY (Nagle 算法禁用)** | 5-10            | **0.5**                 | 0.5                     | **1**               | 掌握 `setsockopt` 及其对性能的影响。          |

Export to Sheets

------



### 阶段 V：高级协议与功能集成



| 序号    | 任务块                             | 预计代码量 (行) | **技术栈学习时间 (天)** | **实现与调试时间 (天)** | **总时间分配 (天)** | 重点/难点                                                    |
| ------- | ---------------------------------- | --------------- | ----------------------- | ----------------------- | ------------------- | ------------------------------------------------------------ |
| **V-1** | **HTTP/1.1 Range 请求支持**        | 80-150          | **1**                   | 3                       | **4**               | 掌握 `206 Partial Content` 响应格式和文件 I/O 偏移量。       |
| **V-2** | **Websocket 协议支持 (握手/分帧)** | 150-250         | **4**                   | 5-7                     | **9-11**            | **难度大**：学习 **Websocket 帧协议**、密钥计算和状态机。    |
| **V-3** | **HTTP/2 协议基础集成**            | 200+            | **5-7**                 | 8-12+                   | **13-19+**          | **巨大挑战**：学习 **HTTP/2 二进制帧**、**HPACK** 及 **nghttp2** 库的用法。 |

Export to Sheets

------



### 阶段 VI：生产级与系统管理



| 序号     | 任务块                       | 预计代码量 (行) | **技术栈学习时间 (天)** | **实现与调试时间 (天)** | **总时间分配 (天)** | 重点/难点                                         |
| -------- | ---------------------------- | --------------- | ----------------------- | ----------------------- | ------------------- | ------------------------------------------------- |
| **VI-1** | **优雅关闭与信号处理**       | 70-120          | **2**                   | 3-4                     | **5-6**             | 掌握 **Linux 信号处理**、多线程环境下的信号安全。 |
| **VI-2** | **运行时指标暴露 (Metrics)** | 100-150         | **1**                   | 3                       | **4**               | 学习 **Prometheus 格式**，实现线程安全的计数器。  |
| **VI-3** | **反向代理/负载均衡转发**    | 200+            | **3**                   | 5-7                     | **8-10**            | **复杂 I/O**：学习双向转发和后端连接池管理。      |

Export to Sheets

------



### 任务清单总览（包含学习时间）



| 阶段     | 重点目标            | 预计总代码量 (行) | 预计总学习时间 (天) | 预计总实现时间 (天) | **预计总时间 (天)** |
| -------- | ------------------- | ----------------- | ------------------- | ------------------- | ------------------- |
| **IV**   | 底层性能和 I/O 效率 | ~200-300          | ~5.5                | ~8-9                | **~13-14**          |
| **V**    | 复杂协议支持        | ~430-600+         | ~10-12              | ~16-22+             | **~26-34+**         |
| **VI**   | 生产级管理和集成    | ~370-500+         | ~6                  | ~11-14              | **~17-20**          |
| **总计** | 深度优化与扩展      | **~1000-1400+**   | **~21.5-23.5**      | **~35-45+**         | **~56-68+**         |

Export to Sheets